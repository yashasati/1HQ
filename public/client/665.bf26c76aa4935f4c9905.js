"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[665,296],{6665:(X,F,n)=>{n.r(F),n.d(F,{CrupdatePersonModule:()=>nt});var e=n(4364),O=n(6798),b=n(3786),d=n(847);let M=(()=>{class g{constructor(l){this.id=l}}return g.type="[CrupdatePerson] Load Person",g})(),$=(()=>{class g{constructor(l){this.id=l}}return g.type="[CrupdatePerson] Detach Credit",g})(),N=(()=>{class g{constructor(l){this.payload=l}}return g.type="[CrupdatePerson] Create Person",g})(),P=(()=>{class g{constructor(l){this.payload=l}}return g.type="[CrupdatePerson] Update Person",g})(),x=(()=>{class g{}return g.type="[CrupdatePerson] Reset State",g})();class E{constructor(r={}){for(const l in r)this[l]=r[l]}}var U=n(8636),H=n(1435),t=n(2316),S=n(5810),u=n(3340);let p=class{constructor(r,l){this.people=r,this.titles=l}static person(r){return r.person}static loading(r){return r.loading}static credits(r){return r.credits}loadPerson(r,l){return r.patchState({loading:!0}),this.people.get(l.id).pipe((0,U.b)(T=>{r.patchState({person:T.person,credits:this.flattenCredits(T.credits),loading:!1})}))}createPerson(r,l){return r.patchState({loading:!0}),this.people.create(l.payload).pipe((0,H.x)(()=>r.patchState({loading:!1})),(0,U.b)(T=>r.patchState({person:T.person})))}updatePerson(r,l){return r.patchState({loading:!0}),this.people.update(r.getState().person.id,l.payload).pipe((0,H.x)(()=>r.patchState({loading:!1})),(0,U.b)(T=>r.patchState({person:T.person})))}removeCredit(r,l){return r.patchState({loading:!0}),this.titles.removeCredit(l.id).pipe((0,U.b)(()=>{const T=r.getState().credits.filter(G=>G.pivot.id!==l.id);r.patchState({credits:T})}),(0,H.x)(()=>r.patchState({loading:!1})))}resetState(r){r.patchState({person:new E,credits:[],loading:!1})}flattenCredits(r){const l=[];return Object.keys(r).forEach(T=>{l.push(...r[T])}),l}};p.\u0275fac=function(r){return new(r||p)(t.LFG(S.g),t.LFG(u.d))},p.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac}),(0,b.gn)([(0,d.aU)(M)],p.prototype,"loadPerson",null),(0,b.gn)([(0,d.aU)(N)],p.prototype,"createPerson",null),(0,b.gn)([(0,d.aU)(P)],p.prototype,"updatePerson",null),(0,b.gn)([(0,d.aU)($)],p.prototype,"removeCredit",null),(0,b.gn)([(0,d.aU)(x)],p.prototype,"resetState",null),(0,b.gn)([(0,d.Qf)()],p,"person",null),(0,b.gn)([(0,d.Qf)()],p,"loading",null),(0,b.gn)([(0,d.Qf)()],p,"credits",null),p=(0,b.gn)([(0,d.ZM)({name:"crupdatePerson",defaults:{person:new E,credits:[],loading:!1}})],p);var A=n(6491),C=n(707),I=n(9141),R=n(6313),j=n(3534),w=n(6142),J=n(5718),Z=n(1707),L=n(9348),Q=n(1654),Y=n(781),z=n(5515),_=n(298),m=n(2529),y=n(6536),a=n(382),o=n(1303),h=n(616),v=n(6403),s=n(3297);function f(g,r){if(1&g){const l=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"div",45),t._UZ(3,"media-image",46),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"td",47),t._uU(7),t.qZA(),t.TgZ(8,"td",48),t._uU(9),t.qZA(),t.TgZ(10,"td",49),t._uU(11),t.qZA(),t.TgZ(12,"td",50),t.TgZ(13,"button",51),t.NdJ("click",function(){const K=t.CHM(l).$implicit;return t.oxw().detachCredit(K)}),t._UZ(14,"mat-icon",52),t.qZA(),t.qZA(),t.qZA()}if(2&g){const l=r.$implicit;t.xp6(3),t.Q6J("src",l.poster),t.xp6(2),t.Oqu(l.name),t.xp6(2),t.Oqu(null!=l.pivot&&l.pivot.character?l.pivot.character:"-"),t.xp6(2),t.hij("",null!=l.pivot&&l.pivot.department?l.pivot.department:"-"," "),t.xp6(2),t.Oqu(null!=l.pivot&&l.pivot.job?l.pivot.job:"-")}}function i(g,r){1&g&&(t.TgZ(0,"no-results-message",53),t.TgZ(1,"span",54),t._uU(2,"Nothing to display."),t.qZA(),t.qZA())}class c{constructor(r,l,T,G,K,W,at){this.store=r,this.toast=l,this.router=T,this.fb=G,this.route=K,this.uploadQueue=W,this.datatable=at,this.poster$=new A.X(null),this.personForm=this.fb.group({name:[""],poster:[""],popularity:[""],description:[""],known_for:[""],birth_place:[""],birth_date:[""],death_date:[""],gender:[null],allow_update:[!0]})}ngOnInit(){this.datatable.init(),this.route.params.subscribe(r=>{this.loadPerson(r)}),this.store.select(p.credits).subscribe(r=>{this.datatable.data=r}),this.personForm.get("poster").valueChanges.subscribe(r=>{this.poster$.next(r)})}ngOnDestroy(){this.store.dispatch(new x),this.datatable.destroy()}uploadPoster(){(0,R.r)({types:[j.j.image]}).then(r=>{this.uploadQueue.start(r,{uri:"uploads/images",httpParams:{diskPrefix:"media-images/posters"}}).subscribe(T=>{this.personForm.patchValue({poster:T.fileEntry.url})})})}loadPerson(r){!r.id||this.store.dispatch(new M(+r.id)).subscribe(()=>{const l=this.store.selectSnapshot(p.person);this.personForm.patchValue(l),this.poster$.next(l.poster)})}submit(){const r=this.store.selectSnapshot(p.person);this.store.dispatch(r.id?new P(this.personForm.value):new N(this.personForm.value)).subscribe(()=>{this.router.navigate([this.router.url.includes("admin")?"admin/people":this.router.url.split("?")[0].replace("/edit","")]),this.toast.open(r.id?C.X.PERSON_UPDATE_SUCCESS:C.X.PERSON_CREATE_SUCCESS)})}detachCredit(r){!r.pivot||this.store.dispatch(new $(r.pivot.id)).subscribe(()=>{this.toast.open(C.X.CREDIT_REMOVE_SUCCESS)})}}c.\u0275fac=function(r){return new(r||c)(t.Y36(d.yh),t.Y36(J.F),t.Y36(O.F0),t.Y36(Z.qu),t.Y36(O.gz),t.Y36(I.A),t.Y36(w.x))},c.\u0275cmp=t.Xpm({type:c,selectors:[["crupdate-person-page"]],features:[t._Bn([I.A,w.x])],decls:90,vars:25,consts:[["animationDuration","0ms","color","accent",1,"material-panel"],[3,"label"],["ngNativeValidate","",1,"primary-facts-panel",3,"formGroup","ngSubmit"],[1,"left-col"],["size","medium",3,"src"],["type","submit","mat-raised-button","","color","accent","trans","",1,"submit-button"],[1,"right-col","many-inputs"],[1,"inline-container","many-inputs"],[1,"input-container"],["for","name","trans",""],["type","text","formControlName","name","id","name","required",""],["for","known_for","trans",""],["type","text","formControlName","known_for","id","known_for"],["for","poster","trans",""],[1,"input-with-action","action-left"],["type","button","mat-flat-button","","color","accent",3,"matTooltip","click"],["svgIcon","file-upload"],["type","text","formControlName","poster","id","poster","minlength","1","maxlength","250"],["for","description","trans",""],["id","description","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","10","cdkAutosizeMaxRows","100"],["for","gender","trans",""],["id","gender","formControlName","gender"],[3,"ngValue"],["value","male","trans",""],["value","female","trans",""],["for","birth_date","trans",""],["type","date","id","birth_date","formControlName","birth_date"],["for","death_date","trans",""],["type","date","id","death_date","formControlName","death_date"],["for","popularity","trans",""],["type","number","formControlName","popularity","id","popularity","min","1","max","1000","step","0.1"],["for","birth_place","trans",""],["type","text","id","birth_place","formControlName","birth_place"],["for","allow_update","trans",""],["formControlName","allow_update","id","allow_update","required",""],["trans","",3,"ngValue"],[1,"responsive-table"],[1,"material-table"],["table-sort-header","name","trans",""],["table-sort-header","pivot.character","trans",""],["table-sort-header","pivot.department","trans",""],["table-sort-header","pivot.job","trans",""],[4,"ngFor","ngForOf"],["svgImage","awards.svg",4,"ngIf"],[1,"overlay",3,"isVisible"],[1,"column-with-image"],["size","small",3,"src"],["data-label","Character",1,"capitalize"],["data-label","Department",1,"capitalize"],["data-label","Job",1,"capitalize"],[1,"edit-column"],["type","button","mat-icon-button","",3,"click"],["svgIcon","close"],["svgImage","awards.svg"],["primary-text","","trans",""]],template:function(r,l){1&r&&(t.TgZ(0,"mat-tab-group",0),t.TgZ(1,"mat-tab",1),t.ALo(2,"trans"),t.TgZ(3,"form",2),t.NdJ("ngSubmit",function(){return l.submit()}),t.TgZ(4,"div",3),t._UZ(5,"media-image",4),t.ALo(6,"async"),t.TgZ(7,"button",5),t._uU(8,"Save"),t.qZA(),t.qZA(),t.TgZ(9,"div",6),t.TgZ(10,"div",7),t.TgZ(11,"div",8),t.TgZ(12,"label",9),t._uU(13,"Name"),t.qZA(),t._UZ(14,"input",10),t.qZA(),t.TgZ(15,"div",8),t.TgZ(16,"label",11),t._uU(17,"Known For"),t.qZA(),t._UZ(18,"input",12),t.qZA(),t.qZA(),t.TgZ(19,"div",8),t.TgZ(20,"label",13),t._uU(21,"Image"),t.qZA(),t.TgZ(22,"div",14),t.TgZ(23,"button",15),t.NdJ("click",function(){return l.uploadPoster()}),t.ALo(24,"trans"),t._UZ(25,"mat-icon",16),t.qZA(),t._UZ(26,"input",17),t.qZA(),t.qZA(),t.TgZ(27,"div",8),t.TgZ(28,"label",18),t._uU(29,"Biography"),t.qZA(),t._UZ(30,"textarea",19),t.qZA(),t.TgZ(31,"div",7),t.TgZ(32,"div",8),t.TgZ(33,"label",20),t._uU(34,"Gender"),t.qZA(),t.TgZ(35,"select",21),t.TgZ(36,"option",22),t._uU(37,"-"),t.qZA(),t.TgZ(38,"option",23),t._uU(39,"Male"),t.qZA(),t.TgZ(40,"option",24),t._uU(41,"Female"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(42,"div",8),t.TgZ(43,"label",25),t._uU(44,"Birth Date"),t.qZA(),t._UZ(45,"input",26),t.qZA(),t.TgZ(46,"div",8),t.TgZ(47,"label",27),t._uU(48,"Death Date"),t.qZA(),t._UZ(49,"input",28),t.qZA(),t.qZA(),t.TgZ(50,"div",7),t.TgZ(51,"div",8),t.TgZ(52,"label",29),t._uU(53,"Popularity"),t.qZA(),t._UZ(54,"input",30),t.qZA(),t.TgZ(55,"div",8),t.TgZ(56,"label",31),t._uU(57,"Birth Place"),t.qZA(),t._UZ(58,"input",32),t.qZA(),t.TgZ(59,"div",8),t.TgZ(60,"label",33),t._uU(61,"Allow Auto Update"),t.qZA(),t.TgZ(62,"select",34),t.TgZ(63,"option",35),t._uU(64,"Yes"),t.qZA(),t.TgZ(65,"option",35),t._uU(66,"No"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(67,"mat-tab",1),t.ALo(68,"trans"),t.TgZ(69,"div",36),t._UZ(70,"datatable-header"),t.TgZ(71,"table",37),t.TgZ(72,"thead"),t.TgZ(73,"tr"),t.TgZ(74,"th",38),t._uU(75,"Credit"),t.qZA(),t.TgZ(76,"th",39),t._uU(77,"Character"),t.qZA(),t.TgZ(78,"th",40),t._uU(79,"Department"),t.qZA(),t.TgZ(80,"th",41),t._uU(81,"Job"),t.qZA(),t._UZ(82,"th"),t.qZA(),t.qZA(),t.TgZ(83,"tbody"),t.YNc(84,f,15,5,"tr",42),t.ALo(85,"async"),t.qZA(),t.qZA(),t.YNc(86,i,3,0,"no-results-message",43),t.ALo(87,"async"),t.qZA(),t.qZA(),t.qZA(),t._UZ(88,"loading-indicator",44),t.ALo(89,"async")),2&r&&(t.xp6(1),t.Q6J("label",t.lcZ(2,11,"Primary Facts")),t.xp6(2),t.Q6J("formGroup",l.personForm),t.xp6(2),t.Q6J("src",t.lcZ(6,13,l.poster$)),t.xp6(18),t.Q6J("matTooltip",t.lcZ(24,15,"Upload poster")),t.xp6(13),t.Q6J("ngValue",null),t.xp6(27),t.Q6J("ngValue",!0),t.xp6(2),t.Q6J("ngValue",!1),t.xp6(2),t.Q6J("label",t.lcZ(68,17,"Credits")),t.xp6(17),t.Q6J("ngForOf",t.lcZ(85,19,l.datatable.data$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(87,21,l.datatable.data$).length),t.xp6(2),t.Q6J("isVisible",t.lcZ(89,23,l.loading$)))},directives:[L.SP,L.uX,Z.JL,Z.sg,Q.P,Y.lW,z.P,Z.Fj,Z.JJ,Z.u,Z.Q7,_.gM,m.Hw,Z.wO,Z.nD,y.IC,Z.EJ,Z.YN,Z.Kr,Z.wV,Z.qQ,Z.Fd,a.G,o.p,e.sg,e.O5,h.Q,v.U],pipes:[s.R,e.Ov],styles:["[_nghost-%COMP%]{display:block;width:100%}[_nghost-%COMP%]     .mat-tab-body-wrapper{padding:20px 0}[_nghost-%COMP%]     .mat-tab-label-content{text-transform:capitalize}[_nghost-%COMP%]     datatable-header .left-column{display:none}[_nghost-%COMP%]     datatable-header .right-column{margin:0}[_nghost-%COMP%]     datatable-header .input-container{width:400px}.inline-container[_ngcontent-%COMP%]{display:flex}.inline-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{flex:1 1 auto}.inline-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:not(:last-of-type){margin-right:15px}.inline-container[_ngcontent-%COMP%]   .input-container.size-small[_ngcontent-%COMP%]{flex:1 1 30%}.mat-tab-group[_ngcontent-%COMP%]{margin-bottom:25px}.primary-facts-panel[_ngcontent-%COMP%]{display:flex}.primary-facts-panel[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]{flex:0 0 200px;width:200px;margin-right:25px}.primary-facts-panel[_ngcontent-%COMP%]   .right-col[_ngcontent-%COMP%]{flex:1 1 auto}.primary-facts-panel[_ngcontent-%COMP%]   media-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;border-radius:4px}.primary-facts-panel[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{width:100%;margin-top:15px;min-height:45px}no-results-message[_ngcontent-%COMP%]{margin:50px 0 40px}"],changeDetection:0}),(0,b.gn)([(0,d.Ph)(p.loading)],c.prototype,"loading$",void 0),(0,b.gn)([(0,d.Ph)(p.credits)],c.prototype,"credits$",void 0);const D=[{path:"",component:c,data:{permissions:["people.update"]}}];let B=(()=>{class g{}return g.\u0275fac=function(l){return new(l||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({imports:[[O.Bz.forChild(D)],O.Bz]}),g})();var V=n(9866),q=n(6895),k=n(5217),tt=n(3389),et=n(557);let nt=(()=>{class g{}return g.\u0275fac=function(l){return new(l||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({imports:[[e.ez,B,V.N,Z.u5,Z.UX,q.M,k.u,tt.p,et.x,d.$l.forFeature([p]),L.Nh,Y.ot,m.Ps,_.AV,y.Ky]]}),g})()},4889:(X,F,n)=>{function e(O){const b=Object.assign({},O);return Object.keys(b).forEach(d=>{(null==b[d]||""===b[d])&&delete b[d]}),b}n.d(F,{N:()=>e})},382:(X,F,n)=>{n.d(F,{G:()=>v});var e=n(2316);const O=[{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:50},{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:50}];var b=n(2100),d=n(2213),M=n(7310),$=n(2529),N=n(5515),P=n(1707),x=n(4364),E=n(781);function U(s,f){1&s&&e.GkF(0)}let H=(()=>{class s{constructor(i,c){this.data=i,this.overlayPanelRef=c}close(){this.overlayPanelRef.close()}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(b.p),e.Y36(M.L))},s.\u0275cmp=e.Xpm({type:s,selectors:[["datatable-filters-panel"]],hostVars:1,hostBindings:function(i,c){2&i&&e.d8E("@dialogContainer","enter")},decls:9,vars:1,consts:[["svgIcon","filter-list"],["trans",""],[1,"body",3,"ngSubmit"],[4,"ngTemplateOutlet"],["type","button","mat-button","","color","accent","trans","",3,"click"]],template:function(i,c){1&i&&(e.TgZ(0,"header"),e._UZ(1,"mat-icon",0),e.TgZ(2,"span",1),e._uU(3,"Filters"),e.qZA(),e.qZA(),e.TgZ(4,"form",2),e.NdJ("ngSubmit",function(){return c.close()}),e.YNc(5,U,1,0,"ng-container",3),e.qZA(),e.TgZ(6,"footer"),e.TgZ(7,"button",4),e.NdJ("click",function(){return c.close()}),e._uU(8,"Close"),e.qZA(),e.qZA()),2&i&&(e.xp6(5),e.Q6J("ngTemplateOutlet",c.data.filters))},directives:[$.Hw,N.P,P._Y,P.JL,P.F,x.tP,E.lW],styles:["[_nghost-%COMP%]{display:block;min-width:250px;margin:auto;background-color:var(--be-background);border-radius:4px;box-shadow:0 8px 9px -5px #0003,0 15px 22px 2px #00000024,0 6px 28px 5px #0000001f}header[_ngcontent-%COMP%]{border-bottom:1px solid var(--be-divider-default);padding:15px 20px;margin-bottom:20px;font-weight:500}header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:5px}.body[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}footer[_ngcontent-%COMP%]{border-top:1px solid var(--be-divider-default);text-align:right;margin-top:10px;padding:10px 20px}"],data:{animation:[d.Nv.dialogContainer]},changeDetection:0}),s})();var t=n(3927),S=n(4889),u=n(6142),p=n(7964),A=n(365),C=n(3297);function I(s,f){1&s&&e._UZ(0,"mat-icon",3)}let R=(()=>{class s{constructor(i){this.datatable=i,this.hideIcon=!1}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(u.x))},s.\u0275cmp=e.Xpm({type:s,selectors:[["datatable-header-search-input"]],inputs:{placeholder:"placeholder",hideIcon:"hideIcon"},decls:4,vars:5,consts:[[1,"input-container","search-input-container"],["type","text",1,"search-input",3,"placeholder","formControl"],["svgIcon","search",4,"ngIf"],["svgIcon","search"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"input",1),e.ALo(2,"trans"),e.YNc(3,I,1,0,"mat-icon",2),e.qZA()),2&i&&(e.xp6(1),e.Q6J("placeholder",e.lcZ(2,3,c.placeholder))("formControl",c.datatable.searchControl),e.xp6(2),e.Q6J("ngIf",!c.hideIcon))},directives:[P.Fj,P.JJ,P.oH,x.O5,$.Hw],pipes:[C.R],styles:[".input-container[_ngcontent-%COMP%]{min-width:250px;position:relative;flex-shrink:0}.input-container[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{position:absolute;top:calc(50% - 12px);right:5px;color:var(--be-secondary-text)}.icon-left[_nghost-%COMP%]   .mat-icon[_ngcontent-%COMP%], .icon-left   [_nghost-%COMP%]   .mat-icon[_ngcontent-%COMP%]{left:10px;right:0}"],changeDetection:0}),s})();var j=n(9243);let w=(()=>{class s extends x.rS{transform(i){return i?super.transform(i.replace("-"," ").replace("_"," ")):""}}return s.\u0275fac=function(){let f;return function(c){return(f||(f=e.n5z(s)))(c||s)}}(),s.\u0275pipe=e.Yjl({name:"titleCase",type:s,pure:!0}),s})();const J=["tableFilters"],Z=["filterButton"];function L(s,f){1&s&&e._UZ(0,"mat-progress-bar",7)}function Q(s,f){1&s&&(e.TgZ(0,"div",8),e.Hsn(1),e.qZA())}const Y=function(s,f){return{count:s,resource:f}};function z(s,f){if(1&s&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"trans"),e.qZA()),2&s){const i=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,":count :resource selected",e.WLB(4,Y,i.numberOfRowsSelected,i.pluralResourceName))," ")}}function _(s,f){if(1&s){const i=e.EpF();e.TgZ(0,"mat-chip",18),e.NdJ("removed",function(){const B=e.CHM(i).$implicit;return e.oxw(3).datatable.removeFilter(B.key)}),e._uU(1),e.ALo(2,"trans"),e.ALo(3,"titleCase"),e._UZ(4,"mat-icon",19),e.qZA()}if(2&s){const i=f.$implicit,c=e.oxw(3);e.Q6J("removable",!0)("selectable",!1),e.xp6(1),e.AsE(" ",e.lcZ(2,4,e.lcZ(3,6,i.key)),": ",c.isModel(i.value)?i.value.name||i.value.display_name:i.value," ")}}function m(s,f){if(1&s){const i=e.EpF();e.ynx(0),e.TgZ(1,"mat-chip-list",13),e.YNc(2,_,5,8,"mat-chip",14),e.ALo(3,"keyvalue"),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"button",15,16),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).openFiltersPanel()}),e._UZ(7,"mat-icon",17),e.qZA(),e.BQk()}if(2&s){const i=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,3,e.lcZ(4,5,i.filters$))),e.xp6(3),e.ekj("active",i.filterPanelRef)}}function y(s,f){if(1&s&&(e.TgZ(0,"div",10),e.YNc(1,m,8,7,"ng-container",11),e._UZ(2,"datatable-header-search-input",12),e.qZA()),2&s){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.filterPanelTemplate),e.xp6(1),e.MGl("placeholder","Search ",i.pluralResourceName,"")}}function a(s,f){1&s&&(e.TgZ(0,"div",20),e.Hsn(1,1),e.qZA())}const o=[[["","leftContent",""]],[["","rightContent",""]]],h=["[leftContent]","[rightContent]"];let v=(()=>{class s{constructor(i,c,D){this.datatable=i,this.cd=c,this.overlayPanel=D,this.showSelectedActions=!0,this.subscriptions=[],this.filters$=this.datatable.filters$.pipe((0,t.U)(B=>{const V=(0,S.N)(B);return delete V.query,V}))}ngOnInit(){const i=this.datatable.filters$.subscribe(()=>{this.filterPanelRef&&this.filterPanelRef.close()}),c=this.datatable.selectedRows$.subscribe(D=>{this.numberOfRowsSelected=D.length,this.cd.markForCheck()});this.subscriptions=[i,c]}ngOnDestroy(){this.subscriptions.forEach(i=>i.unsubscribe())}openFiltersPanel(){if(this.filterPanelRef)this.filterPanelRef.close();else{const i=O.slice();i[0].offsetY=40,i[1].offsetY=40,this.filterPanelRef=this.overlayPanel.open(H,{origin:this.filterButton,position:i,mobilePosition:"center",data:{filters:this.filterPanelTemplate},maxWidth:"90%"}),this.filterButton.nativeElement.classList.add("active"),this.filterPanelRef.afterClosed().subscribe(()=>{this.filterPanelRef=null,this.filterButton.nativeElement.classList.remove("active")})}}isModel(i){return"object"==typeof i&&i.id}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(u.x),e.Y36(e.sBO),e.Y36(p.T))},s.\u0275cmp=e.Xpm({type:s,selectors:[["datatable-header"]],contentQueries:function(i,c,D){if(1&i&&e.Suo(D,J,5),2&i){let B;e.iGM(B=e.CRH())&&(c.filterPanelTemplate=B.first)}},viewQuery:function(i,c){if(1&i&&e.Gf(Z,5,e.SBq),2&i){let D;e.iGM(D=e.CRH())&&(c.filterButton=D.first)}},hostVars:2,hostBindings:function(i,c){2&i&&e.ekj("rows-selected",c.numberOfRowsSelected)},inputs:{pluralResourceName:"pluralResourceName",showSelectedActions:"showSelectedActions"},ngContentSelectors:h,decls:8,vars:7,consts:[["mode","indeterminate","color","accent",4,"ngIf"],[1,"left-column"],["class","default-left-content",4,"ngIf"],["class","selected-left-content capitalize",4,"ngIf"],[1,"right-column"],["class","default-right-content",4,"ngIf"],["class","selected-right-actions",4,"ngIf"],["mode","indeterminate","color","accent"],[1,"default-left-content"],[1,"selected-left-content","capitalize"],[1,"default-right-content"],[4,"ngIf"],[3,"placeholder"],["aria-label","Active Filters",1,"filter-chip-list"],[3,"removable","selectable","removed",4,"ngFor","ngForOf"],["mat-icon-button","",1,"filter-button",3,"click"],["filterButton",""],["svgIcon","filter-list"],[3,"removable","selectable","removed"],["matChipRemove","","svgIcon","cancel"],[1,"selected-right-actions"]],template:function(i,c){1&i&&(e.F$t(o),e.YNc(0,L,1,0,"mat-progress-bar",0),e.ALo(1,"async"),e.TgZ(2,"div",1),e.YNc(3,Q,2,0,"div",2),e.YNc(4,z,3,7,"div",3),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,y,3,2,"div",5),e.YNc(7,a,2,0,"div",6),e.qZA()),2&i&&(e.Q6J("ngIf",e.lcZ(1,5,c.datatable.paginator&&c.datatable.paginator.loading$)),e.xp6(3),e.Q6J("ngIf",!c.showSelectedActions||!c.numberOfRowsSelected),e.xp6(1),e.Q6J("ngIf",c.showSelectedActions&&c.numberOfRowsSelected),e.xp6(2),e.Q6J("ngIf",!c.showSelectedActions||!c.numberOfRowsSelected),e.xp6(1),e.Q6J("ngIf",c.showSelectedActions&&c.numberOfRowsSelected))},directives:[x.O5,A.pW,R,j.qn,x.sg,E.lW,$.Hw,j.HS,j.qH],pipes:[x.Ov,C.R,x.Nd,w],styles:[".rows-selected[_nghost-%COMP%], .rows-selected   [_nghost-%COMP%]{background-color:var(--be-accent-emphasis);color:var(--be-secondary-text);font-size:1.5rem;border-color:var(--be-divider-default)}[_nghost-%COMP%]{display:flex;align-items:center;height:85px;padding:15px;border-bottom:1px solid transparent;position:relative}.mat-progress-bar[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.left-column[_ngcontent-%COMP%]{margin-right:auto}.right-column[_ngcontent-%COMP%]{margin-left:25px}.default-right-content[_ngcontent-%COMP%]{display:flex;align-items:center}.filter-button[_ngcontent-%COMP%]{margin-right:10px}.active[_ngcontent-%COMP%]{color:var(--be-accent-default)}.mat-chip[_ngcontent-%COMP%]{text-transform:capitalize}  datatable-header info-popover{margin-left:10px}"],changeDetection:0}),s})()},557:(X,F,n)=>{n.d(F,{x:()=>A});var e=n(4364),O=n(2529),b=n(9866),d=n(4058),M=n(1707),$=n(781),N=n(9243),P=n(365),x=n(7738),E=n(5217),U=n(8097),H=n(2213),t=n(3389),S=n(2316);let u=(()=>{class C{}return C.\u0275fac=function(R){return new(R||C)},C.\u0275mod=S.oAB({type:C}),C.\u0275inj=S.cJS({imports:[[e.ez,b.N,M.UX,O.Ps,$.ot,H.Is,t.p]]}),C})();var p=n(6798);let A=(()=>{class C{}return C.\u0275fac=function(R){return new(R||C)},C.\u0275mod=S.oAB({type:C}),C.\u0275inj=S.cJS({imports:[[e.ez,b.N,M.UX,M.u5,x.G,E.u,U.X,u,p.Bz,$.ot,O.Ps,d.p9,N.Hi,P.Cv],d.p9]}),C})()},6142:(X,F,n)=>{n.d(F,{x:()=>_});var e=n(6491),O=n(9097),b=n(5565),d=n(1134),M=n(3927),$=n(9902),N=n(8636),P=n(2316),x=n(6798),E=n(299),U=n(962);let H=(()=>{class m{constructor(a,o,h){this.router=a,this.http=o,this.localStorage=h,this.params$=new e.X({}),this.paginatedOnce$=new e.X(!1),this.loading$=new e.X(!1),this.response$=new e.X(null),this.dontUpdateQueryParams=!1,this.perPageCacheKey=null,this.noResults$=this.response$.pipe((0,M.U)(v=>this.paginatedOnce$.value&&0===v.pagination.data.length))}get params(){return this.params$.value}get currentPage(){var a,o;return null===(o=null===(a=this.response$.value)||void 0===a?void 0:a.pagination)||void 0===o?void 0:o.current_page}paginate(a={},o,h){const v=this.subscription?{}:this.currentQueryParams();this.params$.next(Object.assign(Object.assign(Object.assign({},this.response$.value?{perPage:this.response$.value.pagination.per_page,page:this.response$.value.pagination.current_page}:{}),v),a)),this.subscription||this.init(o,h)}nextPage(){const a=this.response$.value.pagination.current_page||0;this.paginate(Object.assign(Object.assign({},this.params$.value),{page:a+1,cursor:this.response$.value.pagination.next_cursor}))}previousPage(){const a=this.response$.value.pagination.current_page;this.paginate(Object.assign(Object.assign({},this.params$.value),{page:a-1||1,cursor:this.response$.value.pagination.prev_cursor}))}changePerPage(a){var o;a!==(null===(o=this.params$.value)||void 0===o?void 0:o.perPage)&&(this.perPageCacheKey&&this.localStorage.set(this.perPageCacheKey,a),this.paginate(Object.assign(Object.assign({},this.params$.value),{perPage:a})))}currentQueryParams(){return this.router.routerState.root.snapshot.queryParams}init(a,o){this.subscription=this.params$.pipe((0,$.w)(h=>{this.loading$.next(!0);const v=!this.paginatedOnce$.value;return v&&this.perPageCacheKey&&this.localStorage.get(this.perPageCacheKey)&&(h=Object.assign({perPage:this.localStorage.get(this.perPageCacheKey)},h)),(v&&o?(0,d.of)({pagination:o}):this.http.get(a,h)).pipe((0,N.b)(()=>{this.updateQueryParams(h),this.loading$.next(!1),this.paginatedOnce$.next(!0)},()=>{this.loading$.next(!1),this.paginatedOnce$.next(!0)}))})).subscribe(h=>{this.response$.next(h)})}updateQueryParams(a={}){if(!this.dontUpdateQueryParams){for(const o in a)Array.isArray(a[o])&&(a[o]=a[o].join(","));this.router.navigate([],{queryParams:a,replaceUrl:!0})}}canLoadNextPage(){var a;const o=null===(a=this.response$.value)||void 0===a?void 0:a.pagination;return!!o&&(!!o.next_cursor||this.currentPage<o.last_page)}canLoadPrevPage(){var a;const o=null===(a=this.response$.value)||void 0===a?void 0:a.pagination;return!!o&&(!!o.prev_cursor||this.currentPage>1)}}return m.\u0275fac=function(a){return new(a||m)(P.LFG(x.F0),P.LFG(E.r),P.LFG(U.m))},m.\u0275prov=P.Yz7({token:m,factory:m.\u0275fac}),m})();var t=n(639),S=n(5347),u=n(9170),p=n(4889),A=n(8208);const C={title:"Delete :resource",body:"Are you sure you want to delete selected :resource?",ok:"Delete"};var I=n(2965),R=n(657);function J(m,y){const a=I.pick(y,m);if((0,R.t6)(a)){const o=Number(a);return o<9007199254740991?o:a}return a}function Z(m,y){return m.filter(a=>function(m,y){const a="string"==typeof m?m:Q(m),o=y.trim().toLowerCase();return-1!==a.indexOf(o)}(a,y))}function Q(m){return Object.keys(m).reduce((y,a)=>y+(m[a]&&"object"==typeof m[a]?Q(m[a]):m[a])+"\u25ec","").toLowerCase()}var Y=n(1707),z=n(5381);let _=(()=>{class m{constructor(a,o,h,v){this.modal=a,this.router=o,this.http=h,this.localStorage=v,this.sort$=new e.X({}),this.filters$=new e.X({}),this.searchControl=new Y.NI,this.searchTerm$=new e.X(null),this.staticParams$=new e.X({}),this.paginator=new H(this.router,this.http,this.localStorage),this.ignoreNextParamChange=!1,this.originalData$=new e.X([]),this.data$=new e.X([]),this.selectedRows$=new e.X([])}get data(){return this.data$.value}set data(a){const o=[...a];this.originalData$.next(o),this.data$.next(o),this.ignoreNextParamChange=!0,this.reset()}init(a={}){if(this.config=a,this.staticParams$.next(Object.assign(Object.assign({},this.staticParams$.value),a.staticParams)),a.uri?this.connectToPaginator():a.initialData&&(this.data=a.initialData),a.uri){const o=this.router.routerState.root.snapshot.queryParams,h=o.query;this.searchControl.setValue(h),this.searchTerm$.next(h),this.sort$.next({orderBy:o.orderBy,orderDir:o.orderDir})}return this.searchControlSub=this.searchControl.valueChanges.pipe((0,t.b)(300)).subscribe(o=>{this.searchTerm$.next(o)}),this.mainSub=(0,O.aj)([this.sort$,this.filters$,this.searchTerm$.pipe((0,M.U)(o=>({query:o}))),this.staticParams$]).pipe((0,t.b)(0,b.Z),(0,M.U)(o=>Object.assign({},...o))).subscribe(o=>{if(this.ignoreNextParamChange)return this.ignoreNextParamChange=!1;o=(0,p.N)(o),Object.entries(o).forEach(([h,v])=>{"object"==typeof v&&v.id&&(o[`${h}Id`]=v.id,delete o[h])}),this.config.uri?this.paginator.paginate(o,this.config.uri,this.config.initialData):Object.keys(o).length&&this.data.length&&this.applyLocalTransforms(o)}),this}connectToPaginator(){this.paginatorSub=this.paginator.response$.pipe((0,S.G)()).subscribe(([a,o])=>{var h;const v=this.config.infiniteScroll&&(null===(h=null==a?void 0:a.pagination)||void 0===h?void 0:h.current_page)!==o.pagination.current_page?[...this.data$.value,...o.pagination.data]:o.pagination.data;this.data$.next(v)})}applyLocalTransforms(a){let o=[...this.originalData$.value];a.query&&(o=Z(o,a.query)),a.orderBy&&a.orderDir&&(o=function(m,y,a){return m.sort((o,h)=>{let v=J(o,y),s=J(h,y);const f=typeof v,i=typeof s;f!==i&&("number"===f&&(v+=""),"number"===i&&(s+=""));let c=0;return null!=v&&null!=s?v>s?c=1:v<s&&(c=-1):null!=v?c=1:null!=s&&(c=-1),c*("asc"===a?1:-1)})}(o,a.orderBy,a.orderDir)),this.data$.next(o)}addFilter(a,o){this.filters$.next(Object.assign(Object.assign({},this.filters$.value),{[a]:o}))}removeFilter(a){const o=Object.assign({},this.filters$.value);delete o[a],this.filters$.next(o)}reset(a=null){this.filters$.next({}),this.sort$.next({}),this.selectedRows$.next([]),a&&this.staticParams$.next(a)}openCrupdateResourceModal(a,o,h){return this.modal.open(a,o,h).beforeClosed().pipe((0,u.h)(v=>!!v),(0,N.b)(()=>this.reset()))}confirmResourceDeletion(a){const o=Object.assign(Object.assign({},C),{replacements:{resource:a}});return this.modal.open(A.z,o).afterClosed().pipe((0,u.h)(h=>h))}getCurrentParams(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.sort$.value),this.filters$.value),this.staticParams$.value),this.paginator.params)}destroy(){var a,o,h;null===(a=this.paginatorSub)||void 0===a||a.unsubscribe(),null===(o=this.mainSub)||void 0===o||o.unsubscribe(),null===(h=this.searchControlSub)||void 0===h||h.unsubscribe()}}return m.\u0275fac=function(a){return new(a||m)(P.LFG(z.u),P.LFG(x.F0),P.LFG(E.r),P.LFG(U.m))},m.\u0275prov=P.Yz7({token:m,factory:m.\u0275fac}),m})()},1303:(X,F,n)=>{n.d(F,{p:()=>H});var e=n(9170),O=n(84),b=n(6966),d=n(2316),M=n(6142),$=n(1606),N=n(4364),P=n(2529);const x=["columnName"],E=["table-sort-header",""],U=["*"];let H=(()=>{class t{constructor(u,p,A,C){this.datable=u,this.cd=p,this.focusMonitor=A,this.el=C,this.orderDir=null,this.arrowVisible=!1,this.arrowDirection="down"}get sortDisabled(){var u;return null===(u=this.datable.config)||void 0===u?void 0:u.disableSort}ngOnInit(){this.orderBy||(this.orderBy=(0,b.V)(this.columnName.nativeElement.textContent,"_")),this.sortSub=this.datable.sort$.pipe((0,e.h)(u=>u.orderBy!==this.orderBy)).subscribe(()=>{this.orderDir=null,this.onMouseLeave(),this.cd.markForCheck()})}ngAfterViewInit(){this.focusMonitor.monitor(this.el).subscribe()}ngOnDestroy(){this.sortSub.unsubscribe(),this.focusMonitor.stopMonitoring(this.el)}changeSort(){this.datable.sort$.next({orderBy:this.orderBy,orderDir:this.getDirection(this.orderDir)})}getDirection(u){switch(u){case"asc":return this.arrowVisible=!1,this.orderDir=null;case"desc":return this.arrowVisible=!0,this.arrowDirection="up",this.orderDir="asc";default:return this.arrowVisible=!0,this.arrowDirection="down",this.orderDir="desc"}}onMouseEnter(){var u;(null===(u=this.datable.config)||void 0===u?void 0:u.disableSort)||(this.arrowVisible=!0)}onMouseLeave(){this.arrowVisible=!1,this.orderDir||(this.arrowDirection="down")}handleClick(){var u;(null===(u=this.datable.config)||void 0===u?void 0:u.disableSort)||this.changeSort()}handleKeydown(u){var p;!(null===(p=this.datable.config)||void 0===p?void 0:p.disableSort)&&(u.keyCode===O.L_||u.keyCode===O.K5)&&(u.preventDefault(),this.changeSort())}}return t.\u0275fac=function(u){return new(u||t)(d.Y36(M.x),d.Y36(d.sBO),d.Y36($.tE),d.Y36(d.SBq))},t.\u0275cmp=d.Xpm({type:t,selectors:[["","table-sort-header",""]],viewQuery:function(u,p){if(1&u&&d.Gf(x,7),2&u){let A;d.iGM(A=d.CRH())&&(p.columnName=A.first)}},hostAttrs:["tabindex","0"],hostVars:4,hostBindings:function(u,p){1&u&&d.NdJ("click",function(){return p.handleClick()})("keydown",function(C){return p.handleKeydown(C)})("mouseenter",function(){return p.onMouseEnter()})("mouseleave",function(){return p.onMouseLeave()}),2&u&&d.ekj("active",p.orderDir)("sort-disabled",p.sortDisabled)},inputs:{orderBy:["table-sort-header","orderBy"]},attrs:E,ngContentSelectors:U,decls:5,vars:3,consts:[[1,"text"],["columnName",""],[1,"icon-wrapper",3,"ngClass"],["svgIcon","arrow-downward",1,"sort-icon"]],template:function(u,p){1&u&&(d.F$t(),d.TgZ(0,"span",0,1),d.Hsn(2),d.qZA(),d.TgZ(3,"span",2),d._UZ(4,"mat-icon",3),d.qZA()),2&u&&(d.xp6(3),d.Q6J("ngClass",p.arrowDirection),d.xp6(1),d.ekj("hint-visible",p.arrowVisible))},directives:[N.mk,P.Hw],styles:["[_nghost-%COMP%]{outline:none}[_nghost-%COMP%]:not(.sort-disabled){cursor:pointer}.active[_nghost-%COMP%]   .sort-icon[_ngcontent-%COMP%]{color:var(--be-text);opacity:1;transform:translate(0)}.cdk-keyboard-focused[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{border-bottom:solid 1px currentColor}.text[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;text-transform:capitalize}.sort-icon[_ngcontent-%COMP%]{width:15px;height:15px;vertical-align:middle;transition:all 225ms cubic-bezier(.4,0,.2,1);transform:translateY(25%);opacity:0}.icon-wrapper[_ngcontent-%COMP%]{display:inline-block;margin-left:4px;transition:transform 225ms cubic-bezier(.4,0,.2,1)}.icon-wrapper[_ngcontent-%COMP%]:not(.down){transform:rotate(180deg)}.hint-visible[_ngcontent-%COMP%]{opacity:1;transform:translate(0)}"],changeDetection:0}),t})()}}]);
//# sourceMappingURL=665.bf26c76aa4935f4c9905.js.map